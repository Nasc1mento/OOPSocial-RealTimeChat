DROP DATABASE OOPSOCIAL_DB;

CREATE DATABASE IF NOT EXISTS OOPSOCIAL_DB;

USE OOPSOCIAL_DB;


CREATE TABLE IF NOT EXISTS OS_USERS(
    USR_ID INT NOT NULL AUTO_INCREMENT,
    USR_NAME VARCHAR(255) NOT NULL,
    USR_EMAIL VARCHAR(255) NOT NULL,
    USR_PHONE VARCHAR(255) NOT NULL,
    USR_PASSWORD VARCHAR(255) NOT NULL,
    USR_SALT VARCHAR(255) NOT NULL,
    USR_DATE_CREATION DATE NOT NULL,
    PRIMARY KEY (USR_ID)
);
CREATE TABLE IF NOT EXISTS OS_MESSAGES(
	MSG_ID INT NOT NULL AUTO_INCREMENT,
    MSG_CONTENT TEXT,
    MSG_USR_ID_SOURCE INT NOT NULL,
    MSG_USR_ID_DESTINY INT NOT NULL,
    MSG_DATE DATE,
    PRIMARY KEY (MSG_ID),
    FOREIGN KEY (MSG_USR_ID_SOURCE) REFERENCES OS_USERS (USR_ID),
    FOREIGN KEY (MSG_USR_ID_DESTINY) REFERENCES OS_USERS (USR_ID)
);

CREATE TABLE IF NOT EXISTS OS_GROUPS(
	GRP_ID INT NOT NULL AUTO_INCREMENT,
	GRP_TITLE VARCHAR(255) NOT NULL,
    PRIMARY KEY (GRP_ID)
);

CREATE TABLE IF NOT EXISTS OS_GROUP_USER(
	GRU_ID INT NOT NULL AUTO_INCREMENT,
    GRU_GRP_ID INT NOT NULL,
    GRU_USR_ID INT NOT NULL,
    PRIMARY KEY (GRU_ID),
    FOREIGN KEY (GRU_GRP_ID) REFERENCES OS_GROUPS (GRP_ID),
    FOREIGN KEY (GRU_USR_ID) REFERENCES OS_USERS (USR_ID)
);


CREATE TABLE IF NOT EXISTS OS_GROUP_MESSAGES(
	GRM_ID INT NOT NULL AUTO_INCREMENT,
    GRM_GRP_ID INT NOT NULL,
    GRM_USR_ID INT NOT NULL,
    GRM_CONTENT TEXT,
    GRM_DATE DATE,
    PRIMARY KEY (GRM_ID),
    FOREIGN KEY (GRM_GRP_ID) REFERENCES OS_GROUPS (GRP_ID),
    FOREIGN KEY (GRM_USR_ID) REFERENCES OS_USERS (USR_ID)
);

